#!/bin/bash
##################################################################################
# Modo de uso:                                                                   #
# Copiar este archivo a /usr/local/bin, darle permisos de ejecuciÃ³n (chmod +x) y #
# ejecutar el comando `log {proceso}` desde la consola para ver el log de un     #
# proceso. [proceso puede ser dnode, fs, master, worker o yama]                  #
##################################################################################
logdir="/home/utnso/yatpos/logs"
declare -A procs=([dnode]="DataNode" [fs]="FileSystem" [master]="Master" [worker]="Worker" [yama]="YAMA")
[ "$#" -lt 1 ] && proc="all" || proc="$1"
if ! [[ " ${!procs[@]} " =~ " $proc " ]] && ! [[ " node all " =~ " $proc " ]]; then
	echo "Usage: log [dnode|fs|master|worker|yama|node|all]"
	exit
fi
mkdir -p $logdir && cd $logdir
if [[ "$proc" == "node" ]]; then
	logfiles="DataNode.log Worker.log"
elif [[ "$proc" == "all" ]]; then
	logfiles=$(printf "%s.log " "${procs[@]}")
else
	logfiles="${procs[$1]}.log"
fi
touch $logfiles && tail -qF $logfiles
cd - &> /dev/null
